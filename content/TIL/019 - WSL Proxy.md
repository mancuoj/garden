---
date: 2024-01-19
tags:
  - til
  - wsl
---

## Install Clash First

- WSL2 + Ubuntu
- Incorporate the following into your shell profile, such as `.bashrc` or `.zshrc`

```shell
host_ip=$(cat /etc/resolv.conf | grep "nameserver" | cut -f 2 -d " ")
export all_proxy=http://$host_ip:7890
export http_proxy=http://$host_ip:7890
export https_proxy=http://$host_ip:7890
```

## Alternate Method

- Recognize that `/etc/resolv.conf` is auto-generated by WSL
- To manage this, create a file `/etc/wsl.conf` and insert:

```conf
[network]
generateResolvConf = false
```

- Execute `wsl --shutdown` and restart WSL2
- Unlink resolv.conf `unlink /etc/resolv.conf`

## Thanks

- [Clash 中文网](https://clashcn.com/clash)
- [Fix DNS resolution in WSL2](https://gist.github.com/coltenkrauter/608cfe02319ce60facd76373249b8ca6)
